<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>云平台</title>
    <link rel="stylesheet" href="./css/lab.css">
    <link rel="stylesheet" href="./iconfont/iconfont.css">
    <link rel="stylesheet" href="./iconfont9/iconfont.css">
</head>
<body>
    <div class="container">
        <!--网站的首页，所有的网站的首页都叫index。html因为服务器找首页都是找index.html-->
        <!--布局：从外到内，从上到下，从左到右-->
        <!--css: 浮动/display ；盒子模型 ；文字样式-->

        <!--头部header:负责头部区域的样式， wrapper只负责版心效果 -->
        <div class="header-demo">
            <a href="./index.html"><img src="./images/sonder.png" alt=""></a>
            <div class="demo-choice1">实验总览</div>
            <div class="choice1-1"></div>
            <div class="choice1-2"></div>
            <div class="choice1-3"></div>
            <div class="choice1-4"></div>
            <div class="choice1-5"></div>
            <div class="choice1-6"></div>
            <div class="choice1-7"></div>
            <div class="choice1-8"></div>
            <button class="demo-choice2" onclick="bookExperiment()">实验预约</button>
            <div class="choice2-1"></div>
            <div class="choice2-2"></div>
            <div class="choice2-3"></div>
            <div class="choice2-4"></div>
            <div class="choice2-5"></div>
            <div class="choice2-6"></div>
            <div class="choice2-7"></div>
            <div class="choice2-8"></div>
            <div id="time"></div>
        </div>
        <div class="popup" id="success-popup">
            <span class="close-btn" onclick="closePopup()">×</span>
            <p>预约成功！</p>
        </div>
        <div class="header fixed">
            <div class="header-wrapper">
                <h1 class="header-h1">
                    <a href="./index.html"><img src="./images/sonder.png" alt=""></a>
                </h1>
        
                <!-- 导航 -->
                <div class="nav">
                    <ul class="tool">
                        <li>
                            <a href="./course.html">课程云</a>
                        </li>
                        <li>
                            <a href="./work.html">作业云</a>
                        </li>
                        <li>
                            <a href="#">实验云</a>
                        </li>
                    </ul>
                </div>
        
                <!-- 搜索 -->
                <div class="search">
                    <input type="text" placeholder="输入关键词">
                    <span class="iconfont icon-icon-test1"></span>
                </div>
        
                <!-- 用户 -->
                <div class="user">
                    <a href="./self.html">
                        <img src="./images/user.png" alt="">
                    </a>
                    <a href="javascript:;"><span class="user-name">登录</span></a>
                </div>
            </div>
        </div>

        <!-- 功能区块 -->
        <div class="file-parts">
            <div class="file-title">实验文件上传区</div>
            <div for="upload-file" class="upload-label">
                <img src="./images/worksubmit.jpg" alt="">
            </div>
            <input type="file" id="upload-file" class="upload-input">
            <div id="file-info"></div>
            <div class="progress">
                <div class="bar"></div>
                <div class="percent">0%</div>
            </div>
        </div>
        <div class="file1"></div>
        <div class="file2"></div>
        <div class="file3"></div>
        <div class="file4"></div>
        <div class="file5"></div>
        <div class="file6"></div>
        <div class="file7"></div>
        <div class="file8"></div>

        <div class="book-parts">
            <div class="book-title">实验参数</div>
            <div class="mybook">
                <div class="book-parts1">
                    <label for="sample-size1">学习率:</label>
                    <input type="range" min="0.001" max="0.1" step="0.001" value="0.05" class="slider" id="sample-size1">
                    <span id="sample-size-value1">0.05</span>
                </div>
                <div class="book-parts2">
                    <label for="sample-size2">迭代次数:</label>
                    <input type="range" min="99" max="5000" value="1000" class="slider" id="sample-size2">
                    <span id="sample-size-value2">1000</span>
                </div>
                <div class="book-parts3">
                    <label for="sample-size3">批量大小:</label>
                    <input type="range" min="32" max="256" value="128" class="slider" id="sample-size3">
                    <span id="sample-size-value3">128</span>
                </div>
            </div>
        </div>
        <div class="book1"></div>
        <div class="book2"></div>
        <div class="book3"></div>
        <div class="book4"></div>
        <div class="book5"></div>
        <div class="book6"></div>
        <div class="book7"></div>
        <div class="book8"></div>

        <div class="history-parts">
            <div class="history-title">实验记录</div>
            <table style="width: 340px; height: 180px; border: 1px solid black;">
                <thead>
                    <tr>
                    <th>编号</th>
                    <th>日期</th>
                    <th>实验类型</th>
                    <th>实验状态</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                    <td>1</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    </tr>
                    <tr>
                    <td>2</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    </tr>
                    <tr>
                    <td>3</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    </tr>
                    <tr>
                    <td>4</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="history1"></div>
        <div class="history2"></div>
        <div class="history3"></div>
        <div class="history4"></div>
        <div class="history5"></div>
        <div class="history6"></div>
        <div class="history7"></div>
        <div class="history8"></div>
        <div class="para-parts">
            <div class="para-title">
                实验效率优化
            </div>
            <div class="para-pic">
                <img src="./images/para.png" alt="">
            </div>
        </div>
        <div class="para1"></div>
        <div class="para2"></div>
        <div class="para3"></div>
        <div class="para4"></div>
        <div class="para5"></div>
        <div class="para6"></div>
        <div class="para7"></div>
        <div class="para8"></div>
        <div class="progress-parts">
            <div class="progress-title">实验进度监控</div>
            <div class="circle-container">
                <canvas id="circle" width="150" height="150"></canvas>
                <div id="percentage"></div>
            </div>   
            <div class="circle-container1">
                <canvas id="circle1" width="150" height="150"></canvas>
                <div id="percentage1"></div>
            </div>         
            <div class="progress-title2">损失值</div>
            <div class="progress-title3">准确率</div>                
        </div>
        <div class="progress1"></div>
        <div class="progress2"></div>
        <div class="progress3"></div>
        <div class="progress4"></div>
        <div class="progress5"></div>
        <div class="progress6"></div>
        <div class="progress7"></div>
        <div class="progress8"></div>
        <div class="result-parts">
            <div class="result-title">实验结果反馈</div>
            <div class="result-pic">
                <img src="./images/result.png" alt="">
            </div>
        </div>
        <div class="result1"></div>
        <div class="result2"></div>
        <div class="result3"></div>
        <div class="result4"></div>
        <div class="result5"></div>
        <div class="result6"></div>
        <div class="result7"></div>
        <div class="result8"></div>
        <div class="data-parts">
            <div class="data-title">Sonder智能机器人</div>
            <div id="dialogue-container">
                <div id="dialogue-box">
                  <div id="messages"></div>
                  <div id="input-container">
                    <input type="text" id="user-input" placeholder="请输入指令...">
                    <button id="submit-btn">发送</button>
                  </div>
                </div>
            </div>
        </div>
        <div class="data1"></div>
        <div class="data2"></div>
        <div class="data3"></div>
        <div class="data4"></div>
        <div class="data5"></div>
        <div class="data6"></div>
        <div class="data7"></div>
        <div class="data8"></div>
    </div>

    <script>
        /* 导航栏固定 */
        const header = document.querySelector('.header')
        window.addEventListener('scroll', function () {
            const n = document.documentElement.scrollTop
            if ( n >= 0) {
                header.classList.add('fixed')
            } else {
                header.classList.remove('fixed')
            }
        })

        /* 渲染用户名 */
        const userName = document.querySelector('.user-name')
        function render() {
            const uname = localStorage.getItem('hy-uname')
            if (!uname) {
                userName.innerHTML = '<a href="./load.html">登录</a>'
            }else {
                userName.innerHTML = `<a href="javascript:;">${uname}</a>`
            }
        }
        render()

        const uploadInput = document.getElementById('upload-file');
        const fileInfo = document.getElementById('file-info');
        const progressBar = document.querySelector('.progress');
        const bar = progressBar.querySelector('.bar');
        const percent = progressBar.querySelector('.percent');
        // 点击图片上传文件
        document.querySelector('.upload-label').addEventListener('click', () => {
        uploadInput.click();
        });

        uploadInput.addEventListener('change', () => {
            const file = uploadInput.files[0];
        });

        /* 显示进度条 */
        uploadInput.addEventListener('change', function() {
            progressBar.style.display = 'block';
            // 设置进度条初始值为0
            bar.style.width = '0%';
            percent.innerText = '0%';
            fileInfo.innerText = '';

            // 模拟进度条，每500毫秒增加5%
            let i = 0;
            let interval = setInterval(function() {
            i += 5;
            bar.style.width = i + '%';
            percent.innerText = i + '%';
            if (i === 100) {
                clearInterval(interval);
                setTimeout(function() {
                fileInfo.innerText = '上传成功';
                }, 1000);
            }
            }, 500);
        });

        /* 亮暗分割圆效果 */
        const circle = document.getElementById("circle");
        const percentage = document.getElementById("percentage");

        circle.addEventListener("click", function(event) {
            const rect = circle.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            let angle = Math.atan2(event.clientY - centerY, event.clientX - centerX);
            if (angle < 0) {
                angle += 2 * Math.PI;
            }
            let percent = Math.round((angle / (2 * Math.PI) + 0.25) * 100);
            if (percent > 100) {
                percent -= 100;
            } else if (percent < 0) {
                percent += 100;
            }
            percentage.textContent = percent + "%";
            circle.style.setProperty("--rotate", angle + "rad");
            circle.style.setProperty("--color", percent >= 50 ? "blue" : "gray");
        });

        const circle1 = document.getElementById("circle1");
        const percentage1 = document.getElementById("percentage1");

        circle1.addEventListener("click", function(event1) {
            const rect = circle1.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            let angle = Math.atan2(event.clientY - centerY, event.clientX - centerX);
            if (angle < 0) {
                angle += 2 * Math.PI;
            }
            let percent = Math.round((angle / (2 * Math.PI) + 0.25) * 100);
            if (percent > 100) {
                percent -= 100;
            } else if (percent < 0) {
                percent += 100;
            }
            percentage1.textContent = percent + "%";
            circle1.style.setProperty("--rotate", angle + "rad");
            circle1.style.setProperty("--color", percent >= 50 ? "blue" : "gray");
        });

        /* 学习率 */
        const sampleSizeSlider1 = document.getElementById("sample-size1");
        const sampleSizeValue1 = document.getElementById("sample-size-value1");
        sampleSizeValue1.innerHTML = sampleSizeSlider1.value; // 初始值
        sampleSizeSlider1.addEventListener("input", function() {
            sampleSizeValue1.innerHTML = this.value;
        });

        /* 迭代次数 */
        const sampleSizeSlider2 = document.getElementById("sample-size2");
        const sampleSizeValue2 = document.getElementById("sample-size-value2");
        sampleSizeValue2.innerHTML = sampleSizeSlider2.value; // 初始值
        sampleSizeSlider2.addEventListener("input", function() {
            sampleSizeValue2.innerHTML = this.value;
        });

        /* 批量大小 */
        const sampleSizeSlider3 = document.getElementById("sample-size3");
        const sampleSizeValue3 = document.getElementById("sample-size-value3");
        sampleSizeValue3.innerHTML = sampleSizeSlider3.value; // 初始值
        sampleSizeSlider3.addEventListener("input", function() {
            sampleSizeValue3.innerHTML = this.value;
        });

        // 记录实验开始时间
        const startTime = Date.now();
        const startTimeElement = document.getElementById("start-time");


        /* 聊天机器人 */
        const messagesContainer = document.getElementById("messages");

            function showMessage(message) {
                messagesContainer.innerHTML += `<p class="message">${message}</p>`;
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            function handleUserInput() {
                const userInput = document.getElementById("user-input").value.trim().toLowerCase();
                showMessage(`用户：${userInput}`);
                if (userInput === "你好") {
                    showMessage("Sonder：您好！");
                }else if (userInput === "请帮我查找4月13日的实验数据") {
                    showMessage("Sonder：好的，请给我15秒为你在数据库中查找4月13日的实验数据！");
                }else if (userInput === "感觉你不如原神") {
                    showMessage("Sonder：你说的对，但是《原神》是由米哈游自主研发的一款全新开放世界冒险游戏。游戏发生在一个被称作「提瓦特」的幻想世界，在这里，被神选中的人将被授予「神之眼」，导引元素之力。你将扮演一位名为「旅行者」的神秘角色，在自由的旅行中邂逅性格各异、能力独特的同伴们，和他们一起击败强敌，找回失散的亲人——同时，逐步发掘「原神」的真相。")
                }
                else {
                showMessage("机器人：抱歉，我不理解您的指令。");
                }
                document.getElementById("user-input").value = "";
            }

      document.getElementById("submit-btn").addEventListener("click", handleUserInput);
    
    /* 预约窗口 */
    function bookExperiment() {
        // 这里可以添加一些预约实验的逻辑
        // ...
        
        // 显示预约成功信息的div
        const popup = document.getElementById("success-popup");
        popup.style.display = "block";
    }
      
    function closePopup() {
        // 隐藏div
        const popup = document.getElementById("success-popup");
        popup.style.display = "none";
    }
    // 获取当前时间
    var now = new Date();
        
        // 获取年、月、日、小时、分钟和秒
        var year = now.getFullYear();
        var month = now.getMonth() + 1;
        var day = now.getDate();
        var hour = now.getHours();
        var minute = now.getMinutes();
        var second = now.getSeconds();
        
        // 获取显示时间的div
        var timeDiv = document.getElementById("time");
        
        // 将时间显示在div中
        timeDiv.innerText = "当前时间：" + year + "-" + month + "-" + day + " " + hour + ":" + minute + ":" + second;
    
    </script>
</body>